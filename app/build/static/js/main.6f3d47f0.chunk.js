(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{44:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(19),c=n.n(a),u=n(10),s=n(2),o=n.n(s),i=n(5),l=n(3),b=n(6),j=n.n(b),d="/api/blogs",p=null,f={getAll:function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get(d);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(i.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:p}},e.next=3,j.a.post(d,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){p="Bearer ".concat(e)},addLike:function(){var e=Object(i.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:p}},e.next=3,j.a.put("".concat(d,"/").concat(t.id),t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(i.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:p}},e.next=3,j.a.delete("".concat(d,"/").concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},h=n(0),O=function(e){var t=e.blog,n=e.removeBlog,a=Object(r.useState)(!1),c=Object(l.a)(a,2),u=c[0],s=c[1],b=Object(r.useState)(t.likes),j=Object(l.a)(b,2),d=j[0],p=j[1],O=function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.addLike({likes:d+1,id:t});case 2:p(d+1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)("div",{className:"blog",children:[Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:t.title}),", by ",Object(h.jsx)("em",{children:t.author})]}),Object(h.jsx)("button",{onClick:function(){return s(!u)},className:"showMore",children:u?"hide":"view"}),u?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("p",{children:t.url}),Object(h.jsxs)("p",{children:["likes: ",Object(h.jsx)("span",{"data-likes":!0,children:d})," ",Object(h.jsx)("button",{onClick:function(){return O(t.id)},children:"like"})]}),Object(h.jsx)("p",{children:t.user.username}),Object(h.jsx)("div",{children:Object(h.jsx)("button",{onClick:function(){return n(t)},children:"remove"})})]}):""]})},g={login:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},v=function(e){var t=e.message,n=e.error;return Object(h.jsx)("div",{className:n?"error":"succeed",children:t})},x=Object(r.forwardRef)((function(e,t){var n=e.buttonLabel,a=e.children,c=Object(r.useState)(!0),u=Object(l.a)(c,2),s=u[0],o=u[1],i={display:s?"none":""},b={display:s?"":"none"},j=function(){o(!s)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:j}})),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{style:b,children:Object(h.jsx)("button",{onClick:j,children:n})}),Object(h.jsxs)("div",{style:i,className:"togglableContent",children:[a,Object(h.jsx)("button",{onClick:j,children:"cancel"})]})]})}));x.displayName="Togglable";var m=x;function w(e){var t=e.id,n=e.type,r=e.value,a=e.handleChange;return Object(h.jsxs)("div",{children:[Object(h.jsxs)("label",{htmlFor:t,children:[t,":"]}),Object(h.jsx)("input",{id:t,name:t,type:n,value:r,onChange:a})]})}function k(e){var t=e.userLogin,n=Object(r.useState)(""),a=Object(l.a)(n,2),c=a[0],u=a[1],s=Object(r.useState)(""),o=Object(l.a)(s,2),i=o[0],b=o[1];return Object(h.jsx)(m,{buttonLabel:"login",children:Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({username:c,password:i}),u(""),b("")},children:[Object(h.jsx)(w,{id:"username",type:"text",value:c,handleChange:function(e){return u(e.target.value)}}),Object(h.jsx)(w,{type:"password",value:i,id:"password",handleChange:function(e){return b(e.target.value)}}),Object(h.jsx)("button",{type:"submit",children:"Login"})]})})}function y(e){var t=e.addBlog,n=Object(r.useState)(""),a=Object(l.a)(n,2),c=a[0],u=a[1],s=Object(r.useState)(""),o=Object(l.a)(s,2),i=o[0],b=o[1],j=Object(r.useState)(""),d=Object(l.a)(j,2),p=d[0],f=d[1],O=Object(r.useRef)();return Object(h.jsx)(m,{buttonLabel:"add blog",ref:O,children:Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:c,author:i,url:p}),O.current.toggleVisibility(),u(""),b(""),f("")},children:[Object(h.jsx)(w,{id:"title",type:"text",value:c,handleChange:function(e){return u(e.target.value)}}),Object(h.jsx)(w,{id:"author",type:"text",value:i,handleChange:function(e){return b(e.target.value)}}),Object(h.jsx)(w,{id:"url",type:"text",value:p,handleChange:function(e){return f(e.target.value)}}),Object(h.jsx)("button",{type:"submit",children:"Create new blog"})]})})}var S=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(""),s=Object(l.a)(c,2),b=s[0],j=s[1],d=Object(r.useState)(""),p=Object(l.a)(d,2),x=p[0],m=p[1],w=Object(r.useState)(!0),S=Object(l.a)(w,2),C=S[0],T=S[1];Object(r.useEffect)((function(){f.getAll().then((function(e){return a(e)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogsApp");if(e){var t=JSON.parse(e);j(t),f.setToken(t.token)}}),[]);var B=function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.login(t);case 3:n=e.sent,window.localStorage.setItem("loggedBlogsApp",JSON.stringify(n)),f.setToken(n.token),T(!0),m("Logging as ".concat(n.name)),setTimeout((function(){m("")}),3e3),j(n),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(0),m("Wrong credentials"),T(!1),setTimeout((function(){m(""),T(!0)}),3e3);case 17:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(i.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.create(t);case 3:r=e.sent,a(n.concat(r)),m('a new blog "'.concat(r.title,'", by ').concat(r.author," added to the db")),T(!0),setTimeout((function(){m("")}),3e3),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),m(e.t0.message),T(!1),setTimeout((function(){m(""),T(!0)}),3e3);case 15:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(i.a)(o.a.mark((function e(t){var r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("Do your really want to delete ".concat(t.title," by ").concat(t.author,"?"))){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,f.remove(t.id);case 6:r=n.findIndex((function(e){return e.id===t.id})),(c=Object(u.a)(n)).splice(r,1),a(c),m('"'.concat(t.title,'" by ').concat(t.author," deleted from the db")),T(!0),setTimeout((function(){m("")}),3e3),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(3),m(e.t0.message),T(!1),setTimeout((function(){m(""),T(!0)}),3e3);case 20:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)("div",{children:[x?C?Object(h.jsx)(v,{message:x}):Object(h.jsx)(v,{message:x,error:!0}):null,Object(h.jsx)("h2",{children:"blogs"}),b?Object(h.jsxs)("p",{children:[b.name," is logged in ",Object(h.jsx)("button",{onClick:function(){window.localStorage.removeItem("loggedBlogsApp"),j("")},children:"logout"})]}):Object(h.jsx)(k,{userLogin:B}),Object(h.jsx)("h2",{children:"create new"}),Object(h.jsx)(y,{addBlog:L}),Object(u.a)(n).sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(h.jsx)(O,{blog:e,removeBlog:A},e.id)}))]})};n(44);c.a.render(Object(h.jsx)(S,{}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.6f3d47f0.chunk.js.map